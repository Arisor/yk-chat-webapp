{"version":3,"sources":["webpack:///./src/components/ChatItem.vue?17c8","webpack:///./node_modules/core-js/modules/web.dom-collections.for-each.js","webpack:///./node_modules/core-js/internals/array-for-each.js","webpack:///./node_modules/core-js/modules/es.array.for-each.js","webpack:///./src/views/PrivateChat.vue?3ec0","webpack:///./src/components/ChatItem.vue?de2e","webpack:///src/components/ChatItem.vue","webpack:///./src/components/ChatItem.vue?183e","webpack:///./src/components/ChatItem.vue","webpack:///src/views/PrivateChat.vue","webpack:///./src/views/PrivateChat.vue?871a","webpack:///./src/views/PrivateChat.vue","webpack:///./src/views/PrivateChat.vue?ba9f","webpack:///./node_modules/core-js/internals/array-method-is-strict.js","webpack:///./src/assets/friend.png","webpack:///./node_modules/core-js/internals/dom-iterables.js"],"names":["global","DOMIterables","forEach","createNonEnumerableProperty","COLLECTION_NAME","Collection","CollectionPrototype","prototype","error","$forEach","arrayMethodIsStrict","arrayMethodUsesToLength","STRICT_METHOD","USES_TO_LENGTH","module","exports","callbackfn","this","arguments","length","undefined","$","target","proto","forced","render","_vm","_h","$createElement","_c","_self","staticClass","ref","attrs","finished","on","onLoad","model","value","callback","$$v","loading","expression","_l","item","index","key","$store","getters","userIdGetter","from_user","avator","message","name","_f","time","directives","rawName","modifiers","domProps","$event","type","indexOf","_k","keyCode","preventDefault","handleSendMsg","composing","inputMsg","trim","$forceUpdate","_v","staticRenderFns","class","me","img","_s","_e","msg","props","components","data","computed","watch","methods","lookInfo","$router","push","component","privateDetail","to_user","$route","params","id","$refs","focus","sendMsgBySocket","saveMsgByDB","status","Date","now","$socket","emit","currTime","refershScroll","$nextTick","setIsRead","getUnReadCount","created","dispatch","sockets","getPrivateMsg","fails","METHOD_NAME","argument","method","call","CSSRuleList","CSSStyleDeclaration","CSSValueList","ClientRectList","DOMRectList","DOMStringList","DOMTokenList","DataTransferItemList","FileList","HTMLAllCollection","HTMLCollection","HTMLFormElement","HTMLSelectElement","MediaList","MimeTypeArray","NamedNodeMap","NodeList","PaintRequestList","Plugin","PluginArray","SVGLengthList","SVGNumberList","SVGPathSegList","SVGPointList","SVGStringList","SVGTransformList","SourceBufferList","StyleSheetList","TextTrackCueList","TextTrackList","TouchList"],"mappings":"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","file":"js/chunk-af718732.c919a09c.js","sourcesContent":["import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatItem.vue?vue&type=style&index=0&id=0886acb1&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatItem.vue?vue&type=style&index=0&id=0886acb1&lang=scss&scoped=true&\"","var global = require('../internals/global');\nvar DOMIterables = require('../internals/dom-iterables');\nvar forEach = require('../internals/array-for-each');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  var Collection = global[COLLECTION_NAME];\n  var CollectionPrototype = Collection && Collection.prototype;\n  // some Chrome versions have non-configurable methods on DOMTokenList\n  if (CollectionPrototype && CollectionPrototype.forEach !== forEach) try {\n    createNonEnumerableProperty(CollectionPrototype, 'forEach', forEach);\n  } catch (error) {\n    CollectionPrototype.forEach = forEach;\n  }\n}\n","'use strict';\nvar $forEach = require('../internals/array-iteration').forEach;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar STRICT_METHOD = arrayMethodIsStrict('forEach');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('forEach');\n\n// `Array.prototype.forEach` method implementation\n// https://tc39.github.io/ecma262/#sec-array.prototype.foreach\nmodule.exports = (!STRICT_METHOD || !USES_TO_LENGTH) ? function forEach(callbackfn /* , thisArg */) {\n  return $forEach(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n} : [].forEach;\n","'use strict';\nvar $ = require('../internals/export');\nvar forEach = require('../internals/array-for-each');\n\n// `Array.prototype.forEach` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.foreach\n$({ target: 'Array', proto: true, forced: [].forEach != forEach }, {\n  forEach: forEach\n});\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"private-chat-wrapper\"},[_c('div',{ref:\"chatList\",staticClass:\"chat-content-wrapper\"},[_c('van-list',{attrs:{\"finished\":_vm.finished,\"direction\":\"up\"},on:{\"load\":_vm.onLoad},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},_vm._l((_vm.privateDetail),function(item,index){return _c('div',{key:index},[(_vm.$store.getters.userIdGetter === item.from_user)?_c('ChatItem',{attrs:{\"href\":item.from_user,\"img\":item.avator,\"me\":_vm.$store.getters.userIdGetter === item.from_user,\"msg\":item.message,\"name\":item.name,\"time\":_vm._f(\"calendar\")(item.time)}}):_c('ChatItem',{attrs:{\"href\":item.from_user,\"img\":item.avator,\"me\":_vm.$store.getters.userIdGetter === item.from_user,\"msg\":item.message,\"name\":item.name,\"time\":_vm._f(\"calendar\")(item.time)}})],1)}),0)],1),_c('div',{staticClass:\"input-msg\"},[_c('textarea',{directives:[{name:\"model\",rawName:\"v-model.trim\",value:(_vm.inputMsg),expression:\"inputMsg\",modifiers:{\"trim\":true}}],ref:\"message\",attrs:{\"rows\":\"1\",\"placeholder\":\"请输入\"},domProps:{\"value\":(_vm.inputMsg)},on:{\"keydown\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }$event.preventDefault();return _vm.handleSendMsg($event)},\"input\":function($event){if($event.target.composing){ return; }_vm.inputMsg=$event.target.value.trim()},\"blur\":function($event){return _vm.$forceUpdate()}}}),_c('div',{staticClass:\"btn\",on:{\"click\":_vm.handleSendMsg}},[_vm._v(\"发送\")])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"chat-item\"},[_c('div',{class:_vm.me ? 'mychat' : 'otherchat'},[_c('van-image',{staticClass:\"img\",attrs:{\"lazy-load\":\"\",\"round\":\"\",\"width\":\"1.2rem\",\"height\":\"1.2rem\",\"src\":_vm.img}}),_c('div',{staticClass:\"ci\"},[_c('div',{staticClass:\"nt\"},[(_vm.time)?_c('span',[_vm._v(_vm._s(_vm.time))]):_vm._e(),(_vm.name)?_c('span',[_vm._v(_vm._s(_vm.name))]):_vm._e()]),_c('div',{staticClass:\"msg\"},[_vm._v(_vm._s(_vm.msg))])])],1)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"chat-item\">\r\n    <div :class=\"me ? 'mychat' : 'otherchat'\">\r\n      <van-image class=\"img\" lazy-load round width=\"1.2rem\" height=\"1.2rem\" :src=\"img\" />\r\n      <div class=\"ci\">\r\n        <div class=\"nt\">\r\n          <span v-if=\"time\">{{time}}</span>\r\n          <span v-if=\"name\">{{name}}</span>\r\n        </div>\r\n        <div class=\"msg\">{{msg}}</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'chat-item',\r\n  props: ['me', 'name', 'img', 'msg', 'time', 'href'],\r\n  components: {},\r\n  data () {\r\n    return {}\r\n  },\r\n\r\n  computed: {},\r\n\r\n  watch: {},\r\n\r\n  methods: {\r\n    lookInfo () {\r\n      // console.log('href', this.href)\r\n      this.$router.push(`/user_info/${this.href}`)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.chat-item {\r\n  padding: 20px;\r\n  .mychat {\r\n    display: flex;\r\n    flex-direction: row-reverse;\r\n    .ci {\r\n      display: flex;\r\n      flex-direction: column;\r\n      margin-right: 20px;\r\n      .nt {\r\n        color: #686868;\r\n        display: flex;\r\n        justify-content: flex-end;\r\n        padding: 15px 0;\r\n        & > :first-child {\r\n          padding-right: 10px;\r\n        }\r\n      }\r\n      .msg {\r\n        padding: 20px;\r\n        background-color: #daf4fe;\r\n        border-radius: 10px;\r\n        max-width: 70vw;\r\n        word-break: break-all;\r\n      }\r\n    }\r\n  }\r\n  .otherchat {\r\n    display: flex;\r\n    .ci {\r\n      display: flex;\r\n      flex-direction: column;\r\n      margin-left: 20px;\r\n      .nt {\r\n        color: #686868;\r\n        display: flex;\r\n        flex-direction: row-reverse;\r\n        justify-content: flex-end;\r\n        padding: 15px 0;\r\n        & > :first-child {\r\n          padding-left: 10px;\r\n        }\r\n      }\r\n      .msg {\r\n        padding: 20px;\r\n        background-color: #daf4fe;\r\n        border-radius: 10px;\r\n        max-width: 70vw;\r\n        word-break: break-all;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatItem.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatItem.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ChatItem.vue?vue&type=template&id=0886acb1&scoped=true&\"\nimport script from \"./ChatItem.vue?vue&type=script&lang=js&\"\nexport * from \"./ChatItem.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ChatItem.vue?vue&type=style&index=0&id=0886acb1&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0886acb1\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"private-chat-wrapper\">\r\n    <div class=\"chat-content-wrapper\" ref=\"chatList\">\r\n      <van-list v-model=\"loading\" :finished=\"finished\" @load=\"onLoad\" direction=\"up\">\r\n        <div v-for=\"(item,index) in privateDetail\" :key=\"index\">\r\n          <ChatItem\r\n            v-if=\"$store.getters.userIdGetter === item.from_user\"\r\n            :href=\"item.from_user\"\r\n            :img=\"item.avator\"\r\n            :me=\"$store.getters.userIdGetter === item.from_user\"\r\n            :msg=\"item.message\"\r\n            :name=\"item.name\"\r\n            :time=\"item.time | calendar\"\r\n          ></ChatItem>\r\n          <ChatItem\r\n            v-else\r\n            :href=\" item.from_user \"\r\n            :img=\"item.avator\"\r\n            :me=\"$store.getters.userIdGetter === item.from_user\"\r\n            :msg=\"item.message\"\r\n            :name=\"item.name\"\r\n            :time=\"item.time | calendar\"\r\n          ></ChatItem>\r\n        </div>\r\n      </van-list>\r\n    </div>\r\n    <div class=\"input-msg\">\r\n      <textarea ref=\"message\" rows=\"1\" placeholder=\"请输入\" v-model.trim=\"inputMsg\" @keydown.enter.prevent=\"handleSendMsg\"></textarea>\r\n      <div class=\"btn\" @click=\"handleSendMsg\">发送</div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport ChatItem from '@/components/ChatItem.vue'\r\nimport { getPrivateDetail, savePrivateMsg, setIsRead, getUnReadCount } from '@/api'\r\nexport default {\r\n  components: { ChatItem },\r\n  data () {\r\n    return {\r\n      loading: false,\r\n      finished: false,\r\n      privateDetail: [], // 私聊相关\r\n      inputMsg: ''\r\n    }\r\n  },\r\n  methods: {\r\n    onLoad () {\r\n      this.loading = true\r\n      getPrivateDetail({\r\n        to_user: this.$route.params.id\r\n      })\r\n        .then(res => {\r\n          res.data.privateDetail.forEach(element => {\r\n            this.privateDetail.push({\r\n              from_user: element.from_user,\r\n              avator: require('@/assets/friend.png'),\r\n              message: element.message,\r\n              name: element.name,\r\n              time: element.time\r\n            })\r\n          })\r\n          this.$refs.message.focus()\r\n          this.refershScroll()\r\n          this.loading = false\r\n          this.finished = true\r\n        })\r\n        .catch(() => {\r\n          this.loading = false\r\n          this.finished = true\r\n        })\r\n    },\r\n    // 发送信息\r\n    handleSendMsg () {\r\n      this.$refs.message.focus()\r\n      if (this.inputMsg === '') return\r\n      this.sendMsgBySocket()\r\n      this.saveMsgByDB()\r\n    },\r\n    // 用socket发消息\r\n    sendMsgBySocket () {\r\n      const data = {\r\n        from_user: this.$store.getters.userIdGetter, // 自己的id\r\n        to_user: this.$route.params.id, // 对方id\r\n        name: this.$route.params.name, // 自己的昵称\r\n        avator: '', // 自己的头像\r\n        message: this.inputMsg, // 消息内容\r\n        type: 'private',\r\n        status: '1', // 是否在线 0为不在线 1为在线\r\n        time: Date.now() // 时间\r\n      }\r\n      this.$socket.emit('sendPrivateMsg', data)\r\n      // this.$store.commit('updateListMutation', data)\r\n    },\r\n    // 用数据库存消息\r\n    saveMsgByDB () {\r\n      const currTime = Date.now()\r\n      const data = {\r\n        from_user: this.$store.getters.userIdGetter, // 自己的id\r\n        to_user: this.$route.params.id, // 对方id\r\n        name: this.$route.params.name, // 自己的昵称\r\n        avator: '', // 自己的头像\r\n        message: this.inputMsg, // 消息内容\r\n        type: 'private',\r\n        status: '1', // 是否在线 0为不在线 1为在线\r\n        time: currTime // 时间\r\n      }\r\n      // 存此条私聊信息到数据库\r\n      savePrivateMsg(data).then(res => {\r\n        this.privateDetail.push({\r\n          from_user: this.$store.getters.userIdGetter,\r\n          avator: require('@/assets/friend.png'),\r\n          message: this.inputMsg,\r\n          name: this.$route.params.name,\r\n          time: currTime\r\n        })\r\n        this.inputMsg = ''\r\n        this.refershScroll()\r\n      })\r\n    },\r\n    refershScroll () {\r\n      this.$nextTick(() => {\r\n        this.$refs.chatList.scrollTop = this.$refs.chatList.scrollHeight\r\n      })\r\n    },\r\n    setIsRead () {\r\n      setIsRead({\r\n        from_user: this.$route.params.id\r\n      })\r\n        .then(() => {\r\n          this.getUnReadCount()\r\n        })\r\n    },\r\n    getUnReadCount () {\r\n      getUnReadCount()\r\n        .then((res) => {\r\n          this.$store.dispatch('msgCountAction', res.data.count)\r\n        })\r\n    }\r\n  },\r\n  created () {\r\n    this.$store.dispatch('titleAction', this.$route.params.name)\r\n    this.setIsRead()\r\n  },\r\n  sockets: {\r\n    getPrivateMsg (data) {\r\n      this.privateDetail.push({\r\n        from_user: data.from_user,\r\n        avator: require('@/assets/friend.png'),\r\n        message: data.message,\r\n        name: data.name,\r\n        time: data.time\r\n      })\r\n      this.refershScroll()\r\n      this.setIsRead()\r\n    }\r\n  }\r\n}\r\n</script>\r\n<style lang='scss' scoped>\r\n.private-chat-wrapper {\r\n  .chat-content-wrapper {\r\n    height: calc(100% - 100px);\r\n    overflow: auto;\r\n    background-color: #f7f8fa;\r\n  }\r\n  .input-msg {\r\n    width: 100%;\r\n    height: 100px;\r\n    padding: 15px 20px;\r\n    position: fixed;\r\n    left: 0;\r\n    bottom: 0;\r\n    display: flex;\r\n    align-items: flex-end;\r\n    background-color: #f3f3f3;\r\n    textarea {\r\n      flex-grow: 1;\r\n      box-sizing: content-box;\r\n      border: none;\r\n      resize: none;\r\n      padding: 20px;\r\n      border-radius: 5px;\r\n      margin-right: 20px;\r\n    }\r\n    .btn {\r\n      padding: 20px 50px;\r\n      background-color: #66b3ef;\r\n      color: white;\r\n      border-radius: 5px;\r\n      cursor: not-allowed;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PrivateChat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PrivateChat.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PrivateChat.vue?vue&type=template&id=7c551cca&scoped=true&\"\nimport script from \"./PrivateChat.vue?vue&type=script&lang=js&\"\nexport * from \"./PrivateChat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PrivateChat.vue?vue&type=style&index=0&id=7c551cca&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7c551cca\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PrivateChat.vue?vue&type=style&index=0&id=7c551cca&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PrivateChat.vue?vue&type=style&index=0&id=7c551cca&lang=scss&scoped=true&\"","'use strict';\nvar fails = require('../internals/fails');\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call,no-throw-literal\n    method.call(null, argument || function () { throw 1; }, 1);\n  });\n};\n","module.exports = __webpack_public_path__ + \"img/friend.0093278a.png\";","// iterable DOM collections\n// flag - `iterable` interface - 'entries', 'keys', 'values', 'forEach' methods\nmodule.exports = {\n  CSSRuleList: 0,\n  CSSStyleDeclaration: 0,\n  CSSValueList: 0,\n  ClientRectList: 0,\n  DOMRectList: 0,\n  DOMStringList: 0,\n  DOMTokenList: 1,\n  DataTransferItemList: 0,\n  FileList: 0,\n  HTMLAllCollection: 0,\n  HTMLCollection: 0,\n  HTMLFormElement: 0,\n  HTMLSelectElement: 0,\n  MediaList: 0,\n  MimeTypeArray: 0,\n  NamedNodeMap: 0,\n  NodeList: 1,\n  PaintRequestList: 0,\n  Plugin: 0,\n  PluginArray: 0,\n  SVGLengthList: 0,\n  SVGNumberList: 0,\n  SVGPathSegList: 0,\n  SVGPointList: 0,\n  SVGStringList: 0,\n  SVGTransformList: 0,\n  SourceBufferList: 0,\n  StyleSheetList: 0,\n  TextTrackCueList: 0,\n  TextTrackList: 0,\n  TouchList: 0\n};\n"],"sourceRoot":""}